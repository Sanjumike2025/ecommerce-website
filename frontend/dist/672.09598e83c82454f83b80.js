/*! For license information please see 672.09598e83c82454f83b80.js.LICENSE.txt */
"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[672],{7672:(e,t,r)=>{r.r(t),r.d(t,{default:()=>L});var n=r(6540),a=r(7767),o=r(7834),l=r(3357),c=r(4073),i=r(1081),u=r(538),s=r(8239),m=r(1543),f=r(9799),d=r(2794),p=r(2241),y=r(9067),g=r(6990),b=r(8031),v=r(6831),E=r(2477),h=r(779),A=r(9307),O=r(9428),x=r(7414),w=r(2814),j=r(8763),S=r(1083),k=r(9591),_=r(6459),P=r(6129),C=r.n(P);function D(e){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D(e)}function F(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function T(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?F(Object(r),!0).forEach(function(t){I(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function I(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=D(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=D(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==D(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function N(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",a=r.toStringTag||"@@toStringTag";function o(r,n,a,o){var i=n&&n.prototype instanceof c?n:c,u=Object.create(i.prototype);return R(u,"_invoke",function(r,n,a){var o,c,i,u=0,s=a||[],m=!1,f={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,r){return o=t,c=0,i=e,f.n=r,l}};function d(r,n){for(c=r,i=n,t=0;!m&&u&&!a&&t<s.length;t++){var a,o=s[t],d=f.p,p=o[2];r>3?(a=p===n)&&(i=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=e):o[0]<=d&&((a=r<2&&d<o[1])?(c=0,f.v=n,f.n=o[1]):d<p&&(a=r<3||o[0]>n||n>p)&&(o[4]=r,o[5]=n,f.n=p,c=0))}if(a||r>1)return l;throw m=!0,n}return function(a,s,p){if(u>1)throw TypeError("Generator is already running");for(m&&1===s&&d(s,p),c=s,i=p;(t=c<2?e:i)||!m;){o||(c?c<3?(c>1&&(f.n=-1),d(c,i)):f.n=i:f.v=i);try{if(u=2,o){if(c||(a="next"),t=o[a]){if(!(t=t.call(o,i)))throw TypeError("iterator result is not an object");if(!t.done)return t;i=t.value,c<2&&(c=0)}else 1===c&&(t=o.return)&&t.call(o),c<2&&(i=TypeError("The iterator does not provide a '"+a+"' method"),c=1);o=e}else if((t=(m=f.n<0)?i:r.call(n,f))!==l)break}catch(t){o=e,c=1,i=t}finally{u=1}}return{value:t,done:m}}}(r,a,o),!0),u}var l={};function c(){}function i(){}function u(){}t=Object.getPrototypeOf;var s=[][n]?t(t([][n]())):(R(t={},n,function(){return this}),t),m=u.prototype=c.prototype=Object.create(s);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,R(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e}return i.prototype=u,R(m,"constructor",u),R(u,"constructor",i),i.displayName="GeneratorFunction",R(u,a,"GeneratorFunction"),R(m),R(m,a,"Generator"),R(m,n,function(){return this}),R(m,"toString",function(){return"[object Generator]"}),(N=function(){return{w:o,m:f}})()}function R(e,t,r,n){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}R=function(e,t,r,n){function o(t,r){R(e,t,function(e){return this._invoke(t,r,e)})}t?a?a(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(o("next",0),o("throw",1),o("return",2))},R(e,t,r,n)}function G(e,t,r,n,a,o,l){try{var c=e[o](l),i=c.value}catch(e){return void r(e)}c.done?t(i):Promise.resolve(i).then(n,a)}function B(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var o=e.apply(t,r);function l(e){G(o,n,a,l,c,"next",e)}function c(e){G(o,n,a,l,c,"throw",e)}l(void 0)})}}function W(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o,l,c=[],i=!0,u=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;i=!1}else for(;!(i=(n=o.call(r)).done)&&(c.push(n.value),c.length!==t);i=!0);}catch(e){u=!0,a=e}finally{try{if(!i&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(u)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return z(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?z(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const L=function(){var e=(0,a.g)().id,t=(0,k.A)().token,r=W((0,n.useState)(null),2),P=r[0],D=r[1],F=W((0,n.useState)(!0),2),I=F[0],R=F[1],G=W((0,n.useState)(null),2),z=G[0],L=G[1],$=W((0,n.useState)(!1),2),q=$[0],M=$[1],H=W((0,n.useState)(""),2),Q=H[0],U=H[1],V=(0,n.useRef)(),X=(0,n.useRef)(),Y=function(e){var t=parseFloat(e.price);return e.discount_percentage&&e.discount_percentage>0?t*(1-e.discount_percentage/100):t};(0,n.useEffect)(function(){var r=function(){var r=B(N().m(function r(){var n,a;return N().w(function(r){for(;;)switch(r.p=r.n){case 0:return r.p=0,R(!0),console.log("Fetching order details for ID: ".concat(e)),r.n=1,S.A.get("http://localhost:5000/api/orders/".concat(e),{headers:{Authorization:"Bearer ".concat(t)}});case 1:n=r.v,console.log("Raw API response:",n),D(n.data),console.log("Order data fetched:",n.data),r.n=3;break;case 2:r.p=2,a=r.v,console.error("Error fetching order details:",a),L("Failed to load order details.");case 3:return r.p=3,R(!1),r.f(3);case 4:return r.a(2)}},r,null,[[0,2,3,4]])}));return function(){return r.apply(this,arguments)}}();t&&e&&r()},[e,t]),(0,n.useEffect)(function(){if(P&&P.tracking_number)try{C()(X.current,P.tracking_number,{format:"CODE128",displayValue:!0,height:50,width:2})}catch(e){console.error("Error generating barcode:",e)}},[P]);var J=function(){var e=B(N().m(function e(){var r,n,a;return N().w(function(e){for(;;)switch(e.p=e.n){case 0:if(Q){e.n=1;break}return alert("Please select a cancellation reason."),e.a(2);case 1:return e.p=1,e.n=2,S.A.put("http://localhost:5000/api/orders/".concat(P.id,"/cancel"),{reason:Q},{headers:{Authorization:"Bearer ".concat(t)}});case 2:alert("Order cancelled successfully!"),M(!1),D(function(e){return T(T({},e),{},{status:"Cancelled",cancellation_reason:Q})}),e.n=4;break;case 3:e.p=3,a=e.v,console.error("Error cancelling order:",(null===(r=a.response)||void 0===r||null===(r=r.data)||void 0===r?void 0:r.message)||a.message),alert("Failed to cancel order: "+((null===(n=a.response)||void 0===n||null===(n=n.data)||void 0===n?void 0:n.message)||"Please try again."));case 4:return e.a(2)}},e,null,[[1,3]])}));return function(){return e.apply(this,arguments)}}();if(I)return n.createElement(o.A,{maxWidth:"md",sx:{mt:4,mb:4}},n.createElement(l.A,null),n.createElement(c.A,null,"Loading order details..."));if(z)return n.createElement(o.A,{maxWidth:"md",sx:{mt:4,mb:4}},n.createElement(i.A,{severity:"error"},z));if(!P)return n.createElement(o.A,{maxWidth:"md",sx:{mt:4,mb:4}},n.createElement(c.A,null,"Order not found."));var K=P.items.reduce(function(e,t){return e+Y(t)*t.quantity},0);return n.createElement(o.A,{maxWidth:"lg",sx:{mt:4,mb:4}},n.createElement("div",{ref:V},n.createElement(u.A,{elevation:3,sx:{p:4}},n.createElement(c.A,{variant:"h4",component:"h1",gutterBottom:!0,align:"center"},"Order Details"),n.createElement(s.Ay,{container:!0,spacing:2,sx:{mb:3}},n.createElement(s.Ay,{item:!0,xs:12,sm:6},n.createElement(c.A,{variant:"h6"},"Order Information"),n.createElement(c.A,null,n.createElement("strong",null,"Order ID:")," ",P.id),n.createElement(c.A,null,n.createElement("strong",null,"Date:")," ",new Date(P.order_date).toLocaleDateString()),n.createElement(c.A,null,n.createElement("strong",null,"Status:")," ",P.status),n.createElement(c.A,null,n.createElement("strong",null,"Total Amount:")," $",K.toFixed(2)),n.createElement(c.A,null,n.createElement("strong",null,"Tracking Number:")," ",P.tracking_number||"N/A")),n.createElement(s.Ay,{item:!0,xs:12,sm:6},n.createElement(c.A,{variant:"h6"},"Shipping Information"),n.createElement(c.A,null,n.createElement("strong",null,"Name:")," ",P.first_name," ",P.last_name),n.createElement(c.A,null,n.createElement("strong",null,"Email:")," ",P.email),n.createElement(c.A,null,n.createElement("strong",null,"Mobile:")," ",P.mobile_number),n.createElement(c.A,null,n.createElement("strong",null,"Address:")," ",P.shipping_address),n.createElement(c.A,null,n.createElement("strong",null,"Location:")," ",P.municipal,", ",P.district,", ",P.province))),n.createElement(m.A,{sx:{my:3}}),n.createElement(c.A,{variant:"h6",gutterBottom:!0},"Order Items"),n.createElement(f.A,null,P.items&&P.items.length>0?P.items.map(function(e,t){return n.createElement(d.Ay,{key:t,disablePadding:!0},n.createElement(p.A,{primary:n.createElement(n.Fragment,null,e.name,e.discount_percentage&&e.discount_percentage>0&&n.createElement(c.A,{variant:"body2",color:"text.secondary",sx:{textDecoration:"line-through",ml:1,display:"inline"}},"$",parseFloat(e.price).toFixed(2))),secondary:"".concat(Y(e).toFixed(2)," x ").concat(e.quantity)}),e.image_url&&n.createElement("img",{src:"http://localhost:5000".concat(e.image_url),alt:e.name,style:{width:50,height:50,objectFit:"cover",borderRadius:"4px"}}))}):n.createElement(d.Ay,null,n.createElement(p.A,{primary:"No items found for this order."}))),n.createElement(m.A,{sx:{my:3}}),n.createElement(y.A,{sx:{display:"flex",justifyContent:"center",gap:4,mt:3}},P.tracking_number&&n.createElement(y.A,{sx:{textAlign:"center"}},n.createElement(c.A,{variant:"subtitle1"},"Barcode"),n.createElement("svg",{id:"barcode",ref:X})),P.tracking_number&&n.createElement(y.A,{sx:{textAlign:"center"}},n.createElement(c.A,{variant:"subtitle1"},"QR Code"),n.createElement(_.X,{value:P.tracking_number,size:128,level:"H"}))))),n.createElement(y.A,{sx:{mt:3,textAlign:"center"}},n.createElement(g.A,{variant:"contained",onClick:function(){window.print()}},"Print Order"),"Cancelled"!==P.status&&"Delivered"!==P.status&&n.createElement(g.A,{variant:"outlined",color:"error",sx:{ml:2},onClick:function(){return M(!0)}},"Cancel Order")),n.createElement(b.A,{open:q,onClose:function(){return M(!1)}},n.createElement(v.A,null,"Cancel Order"),n.createElement(E.A,null,n.createElement(c.A,null,"Are you sure you want to cancel this order?"),n.createElement(h.A,{component:"fieldset",margin:"normal"},n.createElement(A.A,{component:"legend"},"Reason for cancellation:"),n.createElement(O.A,{"aria-label":"cancel reason",name:"cancelReason",value:Q,onChange:function(e){return U(e.target.value)}},["Out of stock","Change of mind (not accepted)","Sourcing delay","Found cheaper elsewhere","Delivery time too long","Other"].map(function(e){return n.createElement(x.A,{key:e,value:e,control:n.createElement(w.A,null),label:e})})))),n.createElement(j.A,null,n.createElement(g.A,{onClick:function(){return M(!1)}},"No"),n.createElement(g.A,{onClick:J,color:"error",variant:"contained"},"Yes, Cancel"))))}}}]);