/*! For license information please see 386.d14a35c2ec627b5c8833.js.LICENSE.txt */
"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[386],{1543:(e,t,r)=>{r.d(t,{A:()=>g});var n=r(8587),a=r(8168),i=r(6540),o=r(4164),l=r(5659),c=r(771),u=r(1848),d=r(5669),s=r(1347),m=r(4848);const f=["absolute","children","className","component","flexItem","light","orientation","role","textAlign","variant"],p=(0,u.Ay)("div",{name:"MuiDivider",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.absolute&&t.absolute,t[r.variant],r.light&&t.light,"vertical"===r.orientation&&t.vertical,r.flexItem&&t.flexItem,r.children&&t.withChildren,r.children&&"vertical"===r.orientation&&t.withChildrenVertical,"right"===r.textAlign&&"vertical"!==r.orientation&&t.textAlignRight,"left"===r.textAlign&&"vertical"!==r.orientation&&t.textAlignLeft]}})(({theme:e,ownerState:t})=>(0,a.A)({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(e.vars||e).palette.divider,borderBottomWidth:"thin"},t.absolute&&{position:"absolute",bottom:0,left:0,width:"100%"},t.light&&{borderColor:e.vars?`rgba(${e.vars.palette.dividerChannel} / 0.08)`:(0,c.X4)(e.palette.divider,.08)},"inset"===t.variant&&{marginLeft:72},"middle"===t.variant&&"horizontal"===t.orientation&&{marginLeft:e.spacing(2),marginRight:e.spacing(2)},"middle"===t.variant&&"vertical"===t.orientation&&{marginTop:e.spacing(1),marginBottom:e.spacing(1)},"vertical"===t.orientation&&{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"},t.flexItem&&{alignSelf:"stretch",height:"auto"}),({ownerState:e})=>(0,a.A)({},e.children&&{display:"flex",whiteSpace:"nowrap",textAlign:"center",border:0,borderTopStyle:"solid",borderLeftStyle:"solid","&::before, &::after":{content:'""',alignSelf:"center"}}),({theme:e,ownerState:t})=>(0,a.A)({},t.children&&"vertical"!==t.orientation&&{"&::before, &::after":{width:"100%",borderTop:`thin solid ${(e.vars||e).palette.divider}`,borderTopStyle:"inherit"}}),({theme:e,ownerState:t})=>(0,a.A)({},t.children&&"vertical"===t.orientation&&{flexDirection:"column","&::before, &::after":{height:"100%",borderLeft:`thin solid ${(e.vars||e).palette.divider}`,borderLeftStyle:"inherit"}}),({ownerState:e})=>(0,a.A)({},"right"===e.textAlign&&"vertical"!==e.orientation&&{"&::before":{width:"90%"},"&::after":{width:"10%"}},"left"===e.textAlign&&"vertical"!==e.orientation&&{"&::before":{width:"10%"},"&::after":{width:"90%"}})),v=(0,u.Ay)("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.wrapper,"vertical"===r.orientation&&t.wrapperVertical]}})(({theme:e,ownerState:t})=>(0,a.A)({display:"inline-block",paddingLeft:`calc(${e.spacing(1)} * 1.2)`,paddingRight:`calc(${e.spacing(1)} * 1.2)`},"vertical"===t.orientation&&{paddingTop:`calc(${e.spacing(1)} * 1.2)`,paddingBottom:`calc(${e.spacing(1)} * 1.2)`})),h=i.forwardRef(function(e,t){const r=(0,d.b)({props:e,name:"MuiDivider"}),{absolute:i=!1,children:c,className:u,component:h=(c?"div":"hr"),flexItem:g=!1,light:y=!1,orientation:A="horizontal",role:b=("hr"!==h?"separator":void 0),textAlign:E="center",variant:x="fullWidth"}=r,w=(0,n.A)(r,f),S=(0,a.A)({},r,{absolute:i,component:h,flexItem:g,light:y,orientation:A,role:b,textAlign:E,variant:x}),C=(e=>{const{absolute:t,children:r,classes:n,flexItem:a,light:i,orientation:o,textAlign:c,variant:u}=e,d={root:["root",t&&"absolute",u,i&&"light","vertical"===o&&"vertical",a&&"flexItem",r&&"withChildren",r&&"vertical"===o&&"withChildrenVertical","right"===c&&"vertical"!==o&&"textAlignRight","left"===c&&"vertical"!==o&&"textAlignLeft"],wrapper:["wrapper","vertical"===o&&"wrapperVertical"]};return(0,l.A)(d,s.K,n)})(S);return(0,m.jsx)(p,(0,a.A)({as:h,className:(0,o.A)(C.root,u),role:b,ref:t,ownerState:S},w,{children:c?(0,m.jsx)(v,{className:C.wrapper,ownerState:S,children:c}):null}))});h.muiSkipListHighlight=!0;const g=h},2032:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n.createSvgIcon}});var n=r(8928)},2386:(e,t,r)=>{r.r(t),r.d(t,{default:()=>L});var n=r(6540),a=r(7834),i=r(3551),o=r(4339),l=r(1629),c=r(7465),u=r(3959),d=r(4992),s=r(9455),m=r(2241),f=r(1543),p=r(6718),v=r(5437),h=r(7034),g=r(8159),y=r(9591),A=r(1083),b=r(7767),E=r(7037),x=r(6831),w=r(799),S=r(1043),C=r(5359),O=r(9307),k=r(6477),j=r(1775),P=r(9851),I=r(7071),_=r(1987);function F(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,o,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){u=!0,a=e}finally{try{if(!c&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return M(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?M(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const T=function(e){var t=e.open,r=e.onClose,a=e.onPlaceOrder,o=e.cartItems,d=e.total,s=e.user,p=F((0,n.useState)((null==s?void 0:s.first_name)||""),2),v=p[0],h=p[1],g=F((0,n.useState)((null==s?void 0:s.last_name)||""),2),y=g[0],A=g[1],b=F((0,n.useState)((null==s?void 0:s.email)||""),2),M=b[0],T=b[1],D=F((0,n.useState)((null==s?void 0:s.mobile_number)||""),2),N=D[0],W=D[1],$=F((0,n.useState)((null==s?void 0:s.address)||""),2),q=$[0],R=$[1],B=F((0,n.useState)((null==s?void 0:s.province)||""),2),L=B[0],z=B[1],G=F((0,n.useState)((null==s?void 0:s.district)||""),2),V=G[0],H=G[1],K=F((0,n.useState)((null==s?void 0:s.municipal)||""),2),Q=K[0],U=K[1],Y=F((0,n.useState)("COD"),2),X=Y[0],Z=Y[1];console.log("CheckoutDialog: user prop",s),(0,n.useEffect)(function(){console.log("CheckoutDialog: useEffect triggered by user change",s),h((null==s?void 0:s.first_name)||""),A((null==s?void 0:s.last_name)||""),T((null==s?void 0:s.email)||""),W((null==s?void 0:s.mobile_number)||""),R((null==s?void 0:s.address)||""),z((null==s?void 0:s.province)||""),H((null==s?void 0:s.district)||""),U((null==s?void 0:s.municipal)||"")},[s]);return n.createElement(E.A,{open:t,onClose:r,fullWidth:!0,maxWidth:"sm"},n.createElement(x.A,null,"Proceed to Checkout"),n.createElement(w.A,{dividers:!0},n.createElement(i.A,{variant:"h6",gutterBottom:!0},"Order Summary"),n.createElement(c.A,{disablePadding:!0},o.map(function(e){return n.createElement(u.Ay,{key:e.id,sx:{py:1,px:0}},n.createElement(m.A,{primary:e.name,secondary:"Quantity: ".concat(e.quantity)}),n.createElement(i.A,{variant:"body2"},"$",parseFloat(e.price).toFixed(2)))}),n.createElement(u.Ay,{sx:{py:1,px:0}},n.createElement(m.A,{primary:"Total"}),n.createElement(i.A,{variant:"subtitle1",sx:{fontWeight:"bold"}},"$",d.toFixed(2)))),n.createElement(f.A,{sx:{my:2}}),n.createElement(i.A,{variant:"h6",gutterBottom:!0},"Shipping Details"),n.createElement(S.A,{margin:"dense",id:"firstName",label:"First Name",type:"text",fullWidth:!0,variant:"outlined",value:v,onChange:function(e){return h(e.target.value)},required:!0}),n.createElement(S.A,{margin:"dense",id:"lastName",label:"Last Name",type:"text",fullWidth:!0,variant:"outlined",value:y,onChange:function(e){return A(e.target.value)},required:!0}),n.createElement(S.A,{margin:"dense",id:"email",label:"Email Address",type:"email",fullWidth:!0,variant:"outlined",value:M,onChange:function(e){return T(e.target.value)},required:!0}),n.createElement(S.A,{margin:"dense",id:"mobileNumber",label:"Mobile Number",type:"tel",fullWidth:!0,variant:"outlined",value:N,onChange:function(e){return W(e.target.value)},required:!0,inputProps:{pattern:"^980[0-9]{7}$"},helperText:"Enter 10-digit Nepali mobile number (e.g., 980xxxxxxx)"}),n.createElement(S.A,{autoFocus:!0,margin:"dense",id:"shippingAddress",label:"Street Address / Tole",type:"text",fullWidth:!0,variant:"outlined",multiline:!0,rows:2,value:q,onChange:function(e){return R(e.target.value)},required:!0}),n.createElement(_.A,{onAddressChange:function(e){var t=e.province,r=e.district,n=e.municipal;z(t),H(r),U(n)},initialProvince:L,initialDistrict:V,initialMunicipal:Q}),n.createElement(f.A,{sx:{my:2}}),n.createElement(i.A,{variant:"h6",gutterBottom:!0},"Payment Method"),n.createElement(C.A,{component:"fieldset",margin:"normal"},n.createElement(O.A,{component:"legend"},"Select Payment Method"),n.createElement(k.A,{"aria-label":"payment method",name:"paymentMethod",value:X,onChange:function(e){return Z(e.target.value)}},n.createElement(j.A,{value:"COD",control:n.createElement(P.A,null),label:"Cash on Delivery (COD)"}),n.createElement(j.A,{value:"Esewa",control:n.createElement(P.A,null),label:"Esewa"}),n.createElement(j.A,{value:"Khalti",control:n.createElement(P.A,null),label:"Khalti"}),n.createElement(j.A,{value:"Bank",control:n.createElement(P.A,null),label:"Bank Transfer"})))),n.createElement(I.A,null,n.createElement(l.A,{onClick:r},"Cancel"),n.createElement(l.A,{variant:"contained",onClick:function(){q&&v&&y&&M&&N&&L&&V&&Q?a({firstName:v,lastName:y,email:M,mobileNumber:N,shippingAddress:q,province:L,district:V,municipal:Q,paymentMethod:X}):alert("Please fill in all shipping details and select a full address.")}},"Confirm Order")))};var D=["paymentMethod"];function N(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",a=r.toStringTag||"@@toStringTag";function i(r,n,a,i){var c=n&&n.prototype instanceof l?n:l,u=Object.create(c.prototype);return W(u,"_invoke",function(r,n,a){var i,l,c,u=0,d=a||[],s=!1,m={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,r){return i=t,l=0,c=e,m.n=r,o}};function f(r,n){for(l=r,c=n,t=0;!s&&u&&!a&&t<d.length;t++){var a,i=d[t],f=m.p,p=i[2];r>3?(a=p===n)&&(c=i[(l=i[4])?5:(l=3,3)],i[4]=i[5]=e):i[0]<=f&&((a=r<2&&f<i[1])?(l=0,m.v=n,m.n=i[1]):f<p&&(a=r<3||i[0]>n||n>p)&&(i[4]=r,i[5]=n,m.n=p,l=0))}if(a||r>1)return o;throw s=!0,n}return function(a,d,p){if(u>1)throw TypeError("Generator is already running");for(s&&1===d&&f(d,p),l=d,c=p;(t=l<2?e:c)||!s;){i||(l?l<3?(l>1&&(m.n=-1),f(l,c)):m.n=c:m.v=c);try{if(u=2,i){if(l||(a="next"),t=i[a]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,l<2&&(l=0)}else 1===l&&(t=i.return)&&t.call(i),l<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),l=1);i=e}else if((t=(s=m.n<0)?c:r.call(n,m))!==o)break}catch(t){i=e,l=1,c=t}finally{u=1}}return{value:t,done:s}}}(r,a,i),!0),u}var o={};function l(){}function c(){}function u(){}t=Object.getPrototypeOf;var d=[][n]?t(t([][n]())):(W(t={},n,function(){return this}),t),s=u.prototype=l.prototype=Object.create(d);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,W(e,a,"GeneratorFunction")),e.prototype=Object.create(s),e}return c.prototype=u,W(s,"constructor",u),W(u,"constructor",c),c.displayName="GeneratorFunction",W(u,a,"GeneratorFunction"),W(s),W(s,a,"Generator"),W(s,n,function(){return this}),W(s,"toString",function(){return"[object Generator]"}),(N=function(){return{w:i,m}})()}function W(e,t,r,n){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}W=function(e,t,r,n){function i(t,r){W(e,t,function(e){return this._invoke(t,r,e)})}t?a?a(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(i("next",0),i("throw",1),i("return",2))},W(e,t,r,n)}function $(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function q(e,t,r,n,a,i,o){try{var l=e[i](o),c=l.value}catch(e){return void r(e)}l.done?t(c):Promise.resolve(c).then(n,a)}function R(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,o,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){u=!0,a=e}finally{try{if(!c&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return B(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?B(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const L=function(){var e=(0,g._)(),t=e.cartItems,r=e.addToCart,E=e.removeFromCart,x=e.updateQuantity,w=e.clearCart,S=(0,y.A)(),C=S.user,O=S.token,k=(0,b.Zp)(),j=R((0,n.useState)(!1),2),P=j[0],I=j[1],_=function(e){var t=parseFloat(e.price);return e.discount_percentage&&e.discount_percentage>0?t*(1-e.discount_percentage/100):t},F=t.reduce(function(e,t){return e+_(t)*t.quantity},0),M=function(){I(!1)},W=function(){var e,r=(e=N().m(function e(r){var n,a,i,o,l,c;return N().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,n=t.map(function(e){return{productId:e.id,quantity:e.quantity}}),a=r.paymentMethod,i=$(r,D),e.n=1,A.A.post("http://localhost:5000/api/orders",{items:n,shippingDetails:i,paymentMethod:a},{headers:{Authorization:"Bearer ".concat(O)}});case 1:alert("Order placed successfully!"),w(),M(),k("/client"),e.n=3;break;case 2:e.p=2,c=e.v,console.error("Error placing order:",(null===(o=c.response)||void 0===o||null===(o=o.data)||void 0===o?void 0:o.message)||c.message),alert("Failed to place order: "+((null===(l=c.response)||void 0===l||null===(l=l.data)||void 0===l?void 0:l.message)||"Please try again."));case 3:return e.a(2)}},e,null,[[0,2]])}),function(){var t=this,r=arguments;return new Promise(function(n,a){var i=e.apply(t,r);function o(e){q(i,n,a,o,l,"next",e)}function l(e){q(i,n,a,o,l,"throw",e)}o(void 0)})});return function(e){return r.apply(this,arguments)}}();return n.createElement(a.A,{maxWidth:"md",sx:{py:4}},n.createElement(i.A,{variant:"h4",component:"h1",gutterBottom:!0,align:"center"},"Shopping Cart"),0===t.length?n.createElement(o.A,{elevation:3,sx:{p:4,textAlign:"center"}},n.createElement(i.A,{variant:"h6",color:"text.secondary"},"Your cart is empty."),n.createElement(l.A,{variant:"contained",sx:{mt:2},href:"/"},"Continue Shopping")):n.createElement(o.A,{elevation:3,sx:{p:4}},n.createElement(c.A,null,t.map(function(e){return n.createElement(n.Fragment,{key:e.id},n.createElement(u.Ay,{secondaryAction:n.createElement(d.A,null,n.createElement(s.A,{edge:"end","aria-label":"remove",onClick:function(){return x(e.id,e.quantity-1)},disabled:e.quantity<=1},n.createElement(v.A,null)),n.createElement(s.A,{edge:"end","aria-label":"add",onClick:function(){return r(e)}},n.createElement(p.A,null)),n.createElement(s.A,{edge:"end","aria-label":"delete",onClick:function(){return E(e.id)}},n.createElement(h.A,null)))},n.createElement(m.A,{primary:e.name,secondary:n.createElement(n.Fragment,null,e.discount_percentage&&e.discount_percentage>0?n.createElement(i.A,{variant:"body2",color:"text.secondary",sx:{textDecoration:"line-through"}},"$",parseFloat(e.price).toFixed(2)," x ",e.quantity):null,n.createElement(i.A,{variant:"body2",color:"text.secondary"},"$",_(e).toFixed(2)," x ",e.quantity))}),n.createElement(i.A,{variant:"body1"},"$",(_(e)*e.quantity).toFixed(2))),n.createElement(f.A,null))})),n.createElement(d.A,{sx:{display:"flex",justifyContent:"flex-end",mt:3}},n.createElement(i.A,{variant:"h6"},"Total: $",F.toFixed(2))),n.createElement(d.A,{sx:{display:"flex",justifyContent:"space-between",mt:2}},n.createElement(l.A,{variant:"outlined",color:"error",onClick:w},"Clear Cart"),n.createElement(l.A,{variant:"contained",color:"primary",size:"large",onClick:function(){if(!C)return alert("Please log in to proceed with checkout."),void k("/login");0!==t.length?I(!0):alert("Your cart is empty.")}},"Proceed to Checkout"))),n.createElement(T,{open:P,onClose:M,onPlaceOrder:W,cartItems:t,total:F,user:C}))}},5437:(e,t,r)=>{var n=r(4994);t.A=void 0;var a=n(r(2032)),i=r(4848);t.A=(0,a.default)((0,i.jsx)("path",{d:"M19 13H5v-2h14z"}),"Remove")},6718:(e,t,r)=>{var n=r(4994);t.A=void 0;var a=n(r(2032)),i=r(4848);t.A=(0,a.default)((0,i.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add")},7034:(e,t,r)=>{var n=r(4994);t.A=void 0;var a=n(r(2032)),i=r(4848);t.A=(0,a.default)((0,i.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete")},8928:(e,t,r)=>{r.r(t),r.d(t,{capitalize:()=>a.A,createChainedFunction:()=>i.A,createSvgIcon:()=>o.A,debounce:()=>l.A,deprecatedPropType:()=>c,isMuiElement:()=>u.A,ownerDocument:()=>d.A,ownerWindow:()=>s.A,requirePropFactory:()=>m,setRef:()=>f,unstable_ClassNameGenerator:()=>E,unstable_useEnhancedEffect:()=>p.A,unstable_useId:()=>v.A,unsupportedProp:()=>h,useControlled:()=>g.A,useEventCallback:()=>y.A,useForkRef:()=>A.A,useIsFocusVisible:()=>b.A});var n=r(9071),a=r(8466),i=r(862),o=r(561),l=r(1935);const c=function(e,t){return()=>null};var u=r(6767),d=r(6248),s=r(3749);const m=function(e,t){return()=>null};const f=r(7365).A;var p=r(2778),v=r(1668);const h=function(e,t,r,n,a){return null};var g=r(1159),y=r(3034),A=r(6852),b=r(8851);const E={configure:e=>{n.A.configure(e)}}}}]);